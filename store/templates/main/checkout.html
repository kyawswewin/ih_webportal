{% extends 'main/base.html' %}
{% load widget_tweaks %}

{% block content %}
<div class="container mx-auto px-4 py-5 lg:px-12 max-w-8xl font-serif"> {# Reduced py-16 to py-8 #}
    <h2 class="text-6xl md:text-7xl font-extrabold text-gray-900 mb-8 text-center tracking-tight leading-tight animate-fade-in-down drop-shadow-lg"> {# Reduced mb-16 to mb-8 #}
        Finalize Your <span class="text-gold-600">Luxury</span> Order
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-12 gap-6"> {# Reduced gap-8 to gap-6 #}

        <div class="md:col-span-6 lg:col-span-7 bg-gradient-to-br from-gray-50 to-white rounded-4xl shadow-3xl p-8 md:p-10 border border-gray-100 animate-slide-in-left transform hover:shadow-4xl transition-all duration-500 ease-in-out lg:border-r lg:border-gold-200"> {# Reduced p-10 md:p-12 to p-8 md:p-10 #}
            <h3 class="text-4xl font-bold text-gray-800 mb-8 pb-4 border-b-2 border-gold-200 leading-snug flex items-center"> {# Reduced mb-9 pb-6 to mb-8 pb-4 #}
                <svg class="w-8 h-8 mr-3 text-gold-500" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> {# Reduced w-9 h-9 mr-4 to w-8 h-8 mr-3 #}
                    <path d="M17 18.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM9 18.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM20 6H4a1 1 0 0 0-1 1v1h18V7a1 1 0 0 0-1-1ZM-1 5H5l.4 2h13.2l.4-2ZM21.7 8.3a1 1 0 0 0-.9-.3H3.2a1 1 0 0 0-.9.3 1 1 0 0 0-.2.8l1.5 8a2 2 0 0 0 2 1.7h12a2 2 0 0 0 2-1.7l1.5-8a1 1 0 0 0-.2-.8Z"/>
                </svg>
                Your Exquisite Cart
            </h3>

            {% if cart_items_data %}
            <div class="max-h-[45vh] overflow-y-auto pr-2"> {# max-h remains at [45vh] #}
                <ul class="space-y-4"> {# Reduced space-y-5 to space-y-4 #}
                    {% for item in cart_items_data %}
                    <li class="flex items-center justify-between bg-white py-3 px-4 rounded-3xl shadow-lg transition-all duration-400 ease-in-out hover:shadow-xl hover:bg-gold-50 transform hover:-translate-y-1 hover:scale-100.5 border border-gray-100"> {# Reduced p-5 to py-3 px-4 for tighter vertical space #}
                        <div class="flex items-center flex-grow">
                            {% if item.furniture.image %}
                            <img src="{{ item.furniture.image.url }}" alt="{{ item.furniture.name }}" class="w-20 h-20 object-cover rounded-xl mr-4 border-2 border-gold-100 shadow-md"> {# Reduced w-24 h-24 mr-5 to w-20 h-20 mr-4 #}
                            {% endif %}
                            <div>
                                <p class="font-bold text-lg text-gray-900 mb-1">{{ item.furniture.name }}</p> {# Reduced text-xl to text-lg #}
                                <p class="text-xs text-gray-700"> {# Reduced text-sm to text-xs #}
                                    Quantity: <span class="font-semibold text-gray-800">{{ item.quantity }}</span>
                                    <span class="mx-1.5 text-gray-400">|</span> Unit Price: <span class="font-semibold text-gold-700">${{ item.price|floatformat:2 }}</span>
                                </p>
                            </div>
                        </div>
                        <span class="font-extrabold text-xl text-gold-800 ml-3">${{ item.total|floatformat:2 }}</span> {# Reduced text-2xl to text-xl #}
                    </li>
                    {% endfor %}
                </ul>
            </div>
            <div class="text-right mt-6 p-5 bg-gradient-to-r from-gold-100 to-amber-50 rounded-3xl border-2 border-gold-200 shadow-2xl flex justify-between items-center animate-pulse-light"> {# Reduced mt-8 p-6 to mt-6 p-5 #}
                <p class="text-3xl md:text-3xl font-semibold text-gold-900">Grand Total:</p>
                <p class="text-4xl md:text-5xl font-extrabold text-gold-800 drop-shadow-md">${{ total_cart_amount|floatformat:2 }}</p>
            </div>
            {% else %}
            <div class="bg-gray-50 rounded-3xl shadow-lg p-8 text-center border-2 border-gold-200"> {# Reduced p-10 to p-8 #}
                <svg class="mx-auto h-20 w-20 text-gold-400 mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg> {# Reduced h-24 w-24 mb-8 to h-20 w-20 mb-6 #}
                <p class="text-2xl font-semibold text-gray-800 mb-4">Your cart awaits your treasures!</p> {# Reduced text-3xl mb-5 to text-2xl mb-4 #}
                <p class="text-lg text-gray-700 mb-8 leading-relaxed">It appears your cart is currently empty. Begin your journey by adding exquisite pieces to elevate your space.</p> {# Reduced text-xl mb-10 to text-lg mb-8 #}
                <a href="{% url 'furniture_list' %}" class="inline-flex items-center justify-center px-10 py-4 border border-transparent text-lg font-medium rounded-full shadow-xl text-white bg-gradient-to-r from-gold-600 to-amber-700 hover:from-gold-700 hover:to-amber-800 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-gold-500 transition ease-in-out duration-400 transform hover:scale-105 active:scale-98"> {# Reduced px-12 py-5 text-xl to px-10 py-4 text-lg #}
                    <svg class="w-6 h-6 mr-2 -ml-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"/></svg> {# Reduced w-7 h-7 mr-3 -ml-1 to w-6 h-6 mr-2 -ml-0.5 #}
                    Discover Our Collection
                </a>
            </div>
            {% endif %}
        </div>

        <div class="md:col-span-6 lg:col-span-5 bg-gradient-to-br from-gray-50 to-white rounded-4xl shadow-3xl p-8 md:p-10 border border-gray-100 animate-slide-in-right transform hover:shadow-4xl transition-all duration-500 ease-in-out"> {# Reduced p-10 md:p-12 to p-8 md:p-10 #}
            <h3 class="text-3xl font-bold text-gray-800 mb-8 pb-4 border-b-2 border-gold-200 leading-snug">Shipping & Payment Mastery</h3> {# Reduced text-4xl mb-9 pb-6 to text-3xl mb-8 pb-4 #}
            <form method="post" class="space-y-6"> {# Reduced space-y-8 to space-y-6 #}
                {% csrf_token %}
                {% for field in form %}
                <div class="mb-4"> {# Reduced mb-5 to mb-4 #}
                    <label for="{{ field.id_for_label }}" class="block text-base font-semibold text-gray-800 mb-2">{{ field.label }}</label> {# Reduced text-lg mb-3 to text-base mb-2 #}
                    {% render_field field class="mt-1 block w-full px-5 py-3 border border-gray-300 rounded-xl shadow-inner placeholder-gray-400 focus:outline-none focus:ring-3 focus:ring-gold-500 focus:border-gold-500 text-base transition-all duration-300 ease-in-out bg-white appearance-none hover:border-gold-300" %} {# Reduced px-6 py-4 text-lg to px-5 py-3 text-base #}
                    {% if field.help_text %}
                    <p class="mt-2 text-xs text-gray-600 italic">{{ field.help_text }}</p> {# Reduced mt-3 text-sm to mt-2 text-xs #}
                    {% endif %}
                    {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-700 font-medium flex items-center"> {# Reduced mt-3 text-base to mt-2 text-sm #}
                        <svg class="w-4 h-4 mr-1.5 text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg> {# Reduced w-5 h-5 mr-2 to w-4 h-4 mr-1.5 #}
                        {{ error }}
                    </p>
                    {% endfor %}
                </div>
                {% endfor %}
                {% if form.non_field_errors %}
                <div class="bg-red-100 border-2 border-red-400 text-red-800 px-5 py-3 rounded-xl relative shadow-md" role="alert"> {# Reduced px-6 py-4 to px-5 py-3 #}
                    <strong class="font-bold text-lg">Order Error!</strong> {# Reduced text-xl to text-lg #}
                    <span class="block sm:inline mt-1.5 text-sm"> {# Reduced mt-2 to mt-1.5 text-base to text-sm #}
                        {% for error in form.non_field_errors %}
                        {{ error }}
                        {% endfor %}
                    </span>
                </div>
                {% endif %}
                <button type="submit" class="block mx-auto py-2 px-3 bg-gray-700 from-gold-600 to-amber-700 text-white font-bold text-base md:text-lg rounded-xl shadow-xl hover:from-gold-700 hover:to-amber-800 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-gold-500 transition duration-400 ease-in-out transform hover:scale-105 active:scale-98 flex items-center justify-center whitespace-nowrap">
                    <svg class="w-4 h-4 inline-block mr-1 -mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                    Confirm & Indulge
                </button>
            </form>
        </div>
    </div>
</div>
<style>
/* Custom Color Palette */
.text-gold-600 { color: #DAA520; }
.text-gold-700 { color: #B8860B; }
.text-gold-800 { color: #8B6914; }
.text-gold-900 { color: #664F00; }
.bg-gold-50 { background-color: #FFFACD; }
.bg-gold-100 { background-color: #FAFAD2; }
.border-gold-100 { border-color: #EEE8AA; }
.border-gold-200 { border-color: #FFD700; }
.from-gold-600 { background-color: #DAA520; }
.to-amber-700 { background-color: #D4AF37; }
/* .hover\:from-gold-700:hover { background-color: #B8860B; } */ /* Removed/Commented out as per previous instructions */
/* .hover\:to-amber-800:hover { background-color: #A67C00; } */ /* Removed/Commented out as per previous instructions */
.focus\:ring-gold-500:focus { --tw-ring-color: #FFD700; }
.hover\:border-gold-300:hover { border-color: #FFC000; }

/* Rounded corners */
.rounded-3xl { border-radius: 1.5rem; }
.rounded-4xl { border-radius: 2rem; }

/* Shadows */
.shadow-3xl { box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.25), 0 10px 15px -5px rgba(0, 0, 0, 0.1); }
.shadow-4xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35), 0 15px 20px -7px rgba(0, 0, 0, 0.15); }

/* Keyframe animations for luxury feel */
@keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-50px); }
    to { opacity: 1; transform: translateY(0); }
}
@keyframes slideInLeft {
    from { opacity: 0; transform: translateX(-100px); }
    to { opacity: 1; transform: translateX(0); }
}
@keyframes slideInRight {
    from { opacity: 0; transform: translateX(100px); }
    to { opacity: 1; transform: translateX(0); }
}
@keyframes pulseLight {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.3); }
    50% { transform: scale(1.005); box-shadow: 0 0 15px 5px rgba(255, 215, 0, 0.6); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.3); }
}

/* Apply animations */
.animate-fade-in-down { animation: fadeInDown 1s ease-out forwards; animation-delay: 0.1s; }
.animate-slide-in-left { animation: slideInLeft 1s ease-out forwards; animation-delay: 0.3s; }
.animate-slide-in-right { animation: slideInRight 1s ease-out forwards; animation-delay: 0.5s; }
.animate-pulse-light { animation: pulseLight 3s infinite alternate ease-in-out; }

/* Font styling */
.font-serif { font-family: 'Playfair Display', serif; }
.font-extrabold { font-weight: 900; }
.leading-tight { line-height: 1.15; }
.leading-snug { line-height: 1.375; }

.text-shadow {
    text-shadow: 0px 1px 2px rgba(0, 0, 0, 0.2);
}
</style>
{% endblock %}